# Задача 2.4: Настройка системы навигации (Go Router)

## Подготовка
- Внимательно изучи документы `bizlevel-concept-updated.md` и `status.md` для полного понимания архитектуры проекта и текущего статуса разработки.
- Ознакомься с реализацией из задач первой фазы и задач 2.1-2.3.
- Изучи документацию по Go Router и особенности его работы во Flutter.

## Описание задачи
Требуется настроить систему навигации приложения с использованием Go Router, создать структуру маршрутов, реализовать защищенные маршруты, доступные только авторизованным пользователям, и настроить переходы между экранами с сохранением истории навигации.

Шаги:
1. Создать базовую структуру навигации в директории `src/routing/`:
   - Разработать файл `app_router.dart` с определением всех маршрутов приложения
   - Создать файл `route_paths.dart` для хранения констант путей
   - Реализовать `router_notifier.dart` для отслеживания изменений состояния авторизации
   - Добавить файл `route_guards.dart` для защиты маршрутов

2. Определить основные группы маршрутов:
   - Создать группу публичных маршрутов (доступных без аутентификации)
   - Реализовать группу защищенных маршрутов (требующих аутентификации)
   - Добавить маршруты для системы аутентификации
   - Определить маршруты для основных функциональных модулей

3. Настроить переадресацию в зависимости от состояния аутентификации:
   - Реализовать автоматическую переадресацию неавторизованных пользователей на экран входа
   - Добавить переадресацию авторизованных пользователей на основной экран
   - Настроить сохранение исходного маршрута для возврата после аутентификации

4. Интегрировать Go Router с Riverpod:
   - Создать провайдеры для доступа к роутеру
   - Обеспечить реактивное обновление маршрутов при изменении состояния авторизации
   - Реализовать слушатели изменений для обновления UI

## Технические требования
- Используй последнюю версию Go Router (указанную в документации проекта)
- Реализуй глубокую ссылочность (deep linking) для веб-версии
- Обеспечь корректную работу навигации на мобильных устройствах
- Используй именованные маршруты для удобства навигации
- Реализуй анимированные переходы между экранами
- Обеспечь сохранение состояния при навигации
- Интегрируй систему навигации с состоянием аутентификации через Riverpod
- Реализуй обработку ошибок навигации и 404 страницу
- Обеспечь типобезопасность при передаче параметров в маршрутах

## Связи с другими задачами
- **Зависит от:** Задача 2.2 (AuthService), Задача 2.3 (UI компоненты для аутентификации)
- **Влияет на:** Задача 2.5 (Тестирование системы аутентификации), все последующие задачи, использующие навигацию

## Критерии готовности
- Настроена базовая структура маршрутов приложения
- Реализована защита маршрутов в зависимости от состояния аутентификации
- Работает автоматическая переадресация при изменении состояния авторизации
- Настроены анимированные переходы между экранами
- Корректно работает история навигации и кнопка "назад"
- Реализована обработка ошибок навигации
- Система навигации интегрирована с Riverpod
- Код имеет достаточное документирование

## Примечания
- Go Router имеет особенности работы на веб-платформе, учитывай это при реализации
- При реализации защищенных маршрутов используй возможности Go Router для отложенной загрузки (redirects)
- Учитывай возможность глубоких ссылок при запуске приложения извне
- Тестируй навигацию на разных платформах (веб, мобильные устройства)
- Обрати внимание на обработку случаев, когда пользователь теряет авторизацию во время сессии
- Навигация должна быть интуитивно понятной и соответствовать ожиданиям пользователя

## Завершение
После выполнения задачи добавь в файл `status.md` запись о выполненной работе в следующем формате:

Задача 2.4: Настройка системы навигации (Go Router)
* Статус: Выполнено
* Дата: [Текущая дата]
* Выполненные шаги:
    * Создана базовая структура маршрутов приложения
    * Реализованы защищенные маршруты
    * Настроена автоматическая переадресация
    * Добавлены анимированные переходы между экранами
    * Интегрирована система навигации с Riverpod
* Созданные файлы:
    * src/routing/app_router.dart - определение маршрутов приложения
    * src/routing/route_paths.dart - константы путей
    * src/routing/router_notifier.dart - слушатель изменений состояния
    * src/routing/route_guards.dart - защита маршрутов
    * src/routing/providers/router_providers.dart - провайдеры для навигации
    * src/routing/models/route_params.dart - модели параметров маршрутов
    * src/routing/transitions/page_transitions.dart - анимации переходов
* Проблемы и решения:
    * [Если были проблемы, описание проблем и их решений]