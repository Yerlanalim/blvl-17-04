# Задача 4.4: Разработка UI для просмотра видео

## Подготовка
- Внимательно изучи документы `bizlevel-concept-updated.md` и `status.md` для полного понимания архитектуры проекта и текущего статуса разработки.
- Ознакомься с реализацией из задачи 1.3 (Система темы), 4.1 (VideoService) и с элементами UI из предыдущих фаз.
- Изучи принципы построения адаптивного интерфейса для просмотра видео на различных устройствах.

## Описание задачи
Требуется разработать пользовательский интерфейс для просмотра видео, включая элементы управления, индикатор прогресса и обработку ошибок воспроизведения. Интерфейс должен быть адаптивным для различных устройств, удобным в использовании и соответствовать общему стилю приложения.

Шаги:
1. Создать основной экран просмотра видео в директории `src/features/level_details/presentation/screens/`:
   - Разработать `VideoPlayerScreen` с основным контейнером для плеера
   - Реализовать адаптивную верстку для корректного отображения на различных устройствах
   - Добавить заголовок, описание и метаинформацию о видео
   - Обеспечить интеграцию с системой навигации для перехода к связанным материалам

2. Разработать компоненты управления плеером в директории `src/features/level_details/presentation/widgets/`:
   - Создать виджет `VideoPlayerControls` с кнопками воспроизведения, паузы, перемотки
   - Реализовать виджет `VideoProgressBar` для отображения прогресса просмотра
   - Добавить виджет `VideoQualitySelector` для выбора качества воспроизведения
   - Создать виджет `VideoVolumeControl` для управления громкостью

3. Реализовать обработку различных состояний:
   - Добавить индикатор загрузки для отображения буферизации
   - Реализовать компонент для отображения ошибок воспроизведения с возможностью повторной попытки
   - Создать компонент уведомления о завершении просмотра
   - Добавить обработку потери подключения во время просмотра

4. Интегрировать UI с системой прогресса и обучения:
   - Реализовать отображение информации о связанных тестах и артефактах
   - Добавить индикацию прогресса прохождения уровня
   - Создать кнопки для перехода к следующим материалам после завершения просмотра
   - Реализовать отображение подсказок и дополнительной информации по контенту

5. Создать контроллеры и провайдеры для управления UI:
   - Разработать `VideoPlayerScreenController` для управления интерфейсом
   - Создать провайдеры для взаимодействия с `VideoService`
   - Реализовать логику автоматического скрытия элементов управления при просмотре
   - Добавить поддержку жестов для управления воспроизведением

## Технические требования
- Следуй принципам чистой архитектуры и MVVM паттерну
- Используй Riverpod для управления состоянием UI
- Реализуй адаптивный дизайн для корректной работы на мобильных устройствах, планшетах и десктопе
- Используй систему тем из задачи 1.3 для стилизации компонентов
- Обеспечь поддержку ориентации экрана (портрет/ландшафт) для мобильных устройств
- Реализуй полноэкранный режим просмотра с возможностью возврата
- Используй анимации для плавных переходов между состояниями
- Обеспечь доступность UI (accessibility) для пользователей с ограниченными возможностями
- Минимизируй перерисовки для оптимальной производительности

## Связи с другими задачами
- **Зависит от:** Задача 1.3 (Система темы), Задача 4.1 (VideoService), Задача 3.3 (ProgressManager)
- **Влияет на:** Задача 4.7 (Интеграция и тестирование системы контента)

## Критерии готовности
- Создан полноценный экран для просмотра видео
- Реализованы все необходимые элементы управления плеером
- Интерфейс корректно адаптируется под различные размеры экрана
- Работает отображение различных состояний воспроизведения (загрузка, буферизация, ошибка)
- Реализована интеграция с системой прогресса
- Обеспечено корректное обновление UI при изменении состояния
- Работают жесты и элементы управления
- Интерфейс соответствует общему стилю приложения
- Код имеет достаточное документирование

## Примечания
- Уделите особое внимание UX при просмотре видео, интерфейс должен быть интуитивно понятным и не отвлекать от содержания
- Для мобильных устройств оптимизируйте элементы управления для удобного использования на сенсорных экранах
- Предусмотрите возможность блокировки перехода в спящий режим во время просмотра видео
- Рассмотрите возможность добавления функции "картинка в картинке" (PiP) для мобильных устройств
- Учитывайте особенности автоматического воспроизведения видео на различных платформах
- Для веб-версии обеспечьте корректную работу с различными браузерами
- Предусмотрите возможность пользовательских настроек воспроизведения (автоматическое качество, скорость воспроизведения)
- Реализуйте сохранение настроек воспроизведения между сеансами

## Завершение
После выполнения задачи добавь в файл `status.md` запись о выполненной работе в следующем формате:

Задача 4.4: Разработка UI для просмотра видео
* Статус: Выполнено
* Дата: [Текущая дата]
* Выполненные шаги:
    * Создан основной экран для просмотра видео
    * Разработаны компоненты управления плеером
    * Реализована обработка различных состояний воспроизведения
    * Добавлена интеграция с системой прогресса
    * Настроена адаптивность для различных устройств
    * Реализованы жесты и элементы управления
* Созданные файлы:
    * src/features/level_details/presentation/screens/video_player_screen.dart - экран просмотра видео
    * src/features/level_details/presentation/widgets/video_player_controls.dart - элементы управления плеером
    * src/features/level_details/presentation/widgets/video_progress_bar.dart - индикатор прогресса
    * src/features/level_details/presentation/widgets/video_quality_selector.dart - выбор качества
    * src/features/level_details/presentation/widgets/video_error_display.dart - отображение ошибок
    * src/features/level_details/presentation/controllers/video_player_screen_controller.dart - контроллер экрана
    * src/features/level_details/presentation/providers/video_ui_providers.dart - провайдеры для UI
    * [Другие созданные файлы]
* Проблемы и решения:
    * [Если были проблемы, описание проблем и их решений]