# Задача 1.4: Создание доменных моделей и интерфейсов сервисов

## Подготовка
- Внимательно изучи документы `bizlevel-concept-updated.md` и `status.md` для полного понимания архитектуры проекта и текущего статуса разработки.
- Ознакомься с реализацией из задач 1.1-1.3.
- Особое внимание обрати на раздел "Схема данных Firestore" в концепции проекта.

## Описание задачи
Требуется разработать основные доменные модели данных и интерфейсы сервисов для работы с ними. Это включает создание моделей для пользователей, уровней, прогресса, видео, тестов и артефактов, а также определение контрактов взаимодействия с данными через интерфейсы репозиториев.

Шаги:
1. Создать базовые интерфейсы в директории `src/domain/interfaces/`:
   - Разработать интерфейс `BaseRepository` с общими методами CRUD операций
   - Создать интерфейс `DataService` для централизованного доступа к данным
   - Определить интерфейс `StorageService` для работы с файлами

2. Разработать доменные модели в директории `src/domain/models/`:
   - Создать модель `User` и связанную с ней модель `UserProfile`
   - Реализовать модель `Level` с информацией об уровнях
   - Добавить модель `Progress` для хранения прогресса пользователя
   - Создать модели `Video`, `Test`, `TestQuestion` и `Artifact`
   - Реализовать модель `Skill` для представления навыков пользователя
   - Добавить модель `Achievement` для системы достижений

3. Определить интерфейсы репозиториев в директории `src/domain/repositories/`:
   - Создать интерфейс `UserRepository` для работы с пользователями
   - Реализовать интерфейс `LevelRepository` для управления уровнями
   - Добавить интерфейс `ProgressRepository` для работы с прогрессом
   - Создать интерфейсы `VideoRepository`, `TestRepository` и `ArtifactRepository`
   - Реализовать интерфейс `SkillRepository` для работы с навыками

4. Разработать базовые сервисы в директории `src/domain/services/`:
   - Определить интерфейс `ProgressManager` для централизованного управления прогрессом
   - Создать интерфейс `LevelMapManager` для работы с картой уровней
   - Реализовать интерфейс `AIAssistantService` для будущей интеграции с Gemini API

## Технические требования
- Следуй принципам чистой архитектуры и Domain-Driven Design
- Используй Freezed или json_serializable для создания иммутабельных моделей с сериализацией
- Все модели должны содержать методы toJson, fromJson для сериализации/десериализации
- Интерфейсы репозиториев должны определять методы для асинхронных операций с данными
- Используй Future/Stream для асинхронных операций
- Предусмотри методы для кэширования и оптимизации запросов
- Каждый интерфейс и модель должны иметь документацию с описанием назначения и свойств
- Модели должны соответствовать структуре данных Firestore из документации проекта

## Связи с другими задачами
- **Зависит от:** Задача 1.1 (Инициализация проекта), Задача 1.2 (Базовые сервисы)
- **Влияет на:** Задача 1.5 (Настройка базового DataService), все последующие задачи, связанные с данными

## Критерии готовности
- Созданы все необходимые доменные модели с корректной структурой
- Определены интерфейсы всех репозиториев с методами для работы с данными
- Созданы интерфейсы основных сервисов приложения
- Модели поддерживают сериализацию/десериализацию JSON
- Структура моделей соответствует схеме данных Firestore из документации
- Документация для каждого класса и интерфейса
- Добавлены юнит-тесты для моделей (опционально)

## Примечания
- Создавай модели в соответствии с принципом единой ответственности
- Учитывай связи между моделями (например, Level содержит ссылки на Video, Test, Artifact)
- Используй типизацию везде, где это возможно, избегай dynamic
- Для коллекций используй иммутабельные типы (List, Map вместо ArrayList, HashMap)
- Рассмотри использование sealed classes для представления состояний с конечным числом вариантов
- Обрати внимание на агрегированную модель прогресса для оптимизации чтения/записи

## Завершение
После выполнения задачи добавь в файл `status.md` запись о выполненной работе в следующем формате:

Задача 1.4: Создание доменных моделей и интерфейсов сервисов
* Статус: Выполнено
* Дата: [Текущая дата]
* Выполненные шаги:
    * Созданы базовые интерфейсы для репозиториев и сервисов
    * Разработаны доменные модели для всех основных сущностей
    * Определены интерфейсы для работы с данными
    * Реализованы методы сериализации/десериализации для моделей
* Созданные файлы:
    * src/domain/interfaces/base_repository.dart - базовый интерфейс репозитория
    * src/domain/interfaces/data_service.dart - интерфейс сервиса данных
    * src/domain/interfaces/storage_service.dart - интерфейс сервиса хранения
    * src/domain/models/user.dart, user_profile.dart - модели пользователя
    * src/domain/models/level.dart - модель уровня
    * src/domain/models/progress.dart - модель прогресса
    * src/domain/models/video.dart, test.dart, artifact.dart - модели контента
    * src/domain/models/skill.dart, achievement.dart - модели навыков и достижений
    * src/domain/repositories/* - интерфейсы репозиториев
    * src/domain/services/* - интерфейсы сервисов
* Проблемы и решения:
    * [Если были проблемы, описание проблем и их решений]